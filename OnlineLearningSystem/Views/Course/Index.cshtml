@model OnlineLearningSystem.DTOs.PaginateResultDTO<OnlineLearningSystem.ViewModels.ShowCoursesInfoViewModel>

@{
	ViewData["Title"] = "Courses";
}

<div class="container mt-5">
	<!-- Page Title -->
	<div class="text-center mb-4">
		<h1 class="fw-bold text-primary display-6">Explore Our Courses</h1>
		<p class="text-muted">Discover courses, instructors, and categories tailored for you</p>
	</div>

	<!-- Search & Category Filter -->
	<div class="row mb-4">
		<div class="col-md-6 mb-2 mb-md-0">
			<input type="text" id="searchInput" class="form-control" placeholder="Search courses by name..." />
		</div>
		<div class="col-md-6">
			<select id="categoryFilter" class="form-select">
				<option value="">All Categories</option>
				@foreach (var category in ViewBag.Categories as List<Category>)
				{
					<option value="@category.Id">@category.Name</option>
				}
			</select>
		</div>
	</div>

	<!-- Courses Grid Container -->
	<div id="coursesContainer">
		@await Html.PartialAsync("_CoursesGridPartial", Model)
	</div>
</div>

@section Styles {
	<style>
		.course-card {
			transition: transform 0.2s ease, box-shadow 0.2s ease;
			font-size: 0.9rem;
		}

			.course-card:hover {
				transform: translateY(-4px);
				box-shadow: 0 0.75rem 1.5rem rgba(0,0,0,0.1);
			}
	</style>
}

@section Scripts {
	<script>
		$(document).ready(function () {
			function fetchCourses() {
				var searchTerm = $("#searchInput").val();
				var categoryId = $("#categoryFilter").val(); // use the category ID now

				$.ajax({
					url: '@Url.Action("SearchCourses", "Course")', // controller action
					type: 'GET',
					data: { searchTerm: searchTerm, categoryId: categoryId },
					success: function (result) {
						$("#coursesContainer").html(result); // update the partial
					},
					error: function () {
						alert("Error retrieving courses.");
					}
				});
			}

			// Trigger fetch on typing or changing category
			$("#searchInput").on("keyup", fetchCourses);
			$("#categoryFilter").on("change", fetchCourses);
		});
	</script>
}

